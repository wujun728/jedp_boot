<!DOCTYPE table SYSTEM "../config/table-config-1.0.dtd">
<table sqlname="abs_plan_capital_order" physicalName="abs_plan_capital_order" remark="计划资金交易订单">
    <column name = "CFRM_AMT" jdbctype = "BIGINT" javatype = "com.general.system.common.model.Money" remark="发生后余额"/>
    <column name = "TRANS_AMT" jdbctype = "BIGINT" javatype = "com.general.system.common.model.Money" remark="发起交易实付金额"/>
    <column name = "PAYABLE_AMT" jdbctype = "BIGINT" javatype = "com.general.system.common.model.Money" remark="应付金额"/>

    <!--  特殊字符说明 &lt;&gt; <> -->
    <!-- baseSql option中 select * 会自动替换为 include -->
    <sql id="Base_Column_List">
        ID,CFRM_AMT,TRANS_AMT,PAYABLE_AMT,MEMO,BIZ_NO,PROC_TIME,PLAN_ACCT_CHANNEL,CNT_PTY_ACCT_CHANNEL
        ,SEQ_NO,PLAN_NO,STATUS,CONTEXT,PLAN_ACCT,CNT_PTY_ACCT_TYPE
        ,PLAN_ACCT_TYPE,OUT_ACPT_NO,TRANS_TYPE,CNT_PTY_ACCT,CNT_PTY_CODE
        ,OUT_TRANS_NO,CAPITAL_TYPE,PLAN_ACCT_BANK,PLAN_ACCT_CITY,PLAN_ACCT_NAME
        ,PLAN_ACCT_PROV,CNT_PTY_ACCT_BANK,CNT_PTY_ACCT_CITY,CNT_PTY_ACCT_NAME,CNT_PTY_ACCT_PROV
        ,GMT_CREATE,TRANS_TIME,FINISH_TIME,ACCOUNT_DATE,GMT_MODIFIED,EXEC_TIMES,LAST_EXEC_TIME,NEXT_EXEC_TIME,ROWNUM RN
    </sql>

    <!-- baseSql option中 select sf.* 会自动替换为 include -->
    <sql id="Base_SF_Column_List">
        sf.ID,sf.CFRM_AMT,sf.TRANS_AMT,sf.PAYABLE_AMT,sf.MEMO,sf.BIZ_NO,sf.PROC_TIME,sf.PLAN_ACCT_CHANNEL,sf.CNT_PTY_ACCT_CHANNEL
        ,sf.SEQ_NO,sf.PLAN_NO,sf.STATUS,sf.CONTEXT,sf.PLAN_ACCT,sf.CNT_PTY_ACCT_TYPE
        ,sf.PLAN_ACCT_TYPE,sf.OUT_ACPT_NO,sf.TRANS_TYPE,sf.CNT_PTY_ACCT,sf.CNT_PTY_CODE
        ,sf.OUT_TRANS_NO,sf.CAPITAL_TYPE,sf.PLAN_ACCT_BANK,sf.PLAN_ACCT_CITY,sf.PLAN_ACCT_NAME
        ,sf.PLAN_ACCT_PROV,sf.CNT_PTY_ACCT_BANK,sf.CNT_PTY_ACCT_CITY,sf.CNT_PTY_ACCT_NAME,sf.CNT_PTY_ACCT_PROV
        ,sf.GMT_CREATE,sf.TRANS_TIME,sf.FINISH_TIME,sf.ACCOUNT_DATE,sf.GMT_MODIFIED,EXEC_TIMES,LAST_EXEC_TIME,NEXT_EXEC_TIME,ROWNUM RN
    </sql>

    <operation name="insert" paramtype="object" remark="插入表:ABS_PLAN_CAPITAL_ORDER" >
        <![CDATA[
            INSERT INTO ABS_PLAN_CAPITAL_ORDER(
                    ID
                    ,CFRM_AMT
                    ,TRANS_AMT
                    ,PAYABLE_AMT
                    ,MEMO
                    ,BIZ_NO
                    ,SEQ_NO
                    ,PLAN_NO
                    ,STATUS
                    ,CONTEXT
                    ,PLAN_ACCT
                    ,PLAN_ACCT_TYPE
                    ,OUT_ACPT_NO
                    ,TRANS_TYPE
                    ,CNT_PTY_ACCT
                    ,CNT_PTY_CODE
                    ,OUT_TRANS_NO
                    ,CAPITAL_TYPE
                    ,PLAN_ACCT_BANK
                    ,PLAN_ACCT_CITY
                    ,PLAN_ACCT_NAME
                    ,PLAN_ACCT_PROV
                    ,CNT_PTY_ACCT_BANK
                    ,CNT_PTY_ACCT_CITY
                    ,CNT_PTY_ACCT_NAME
                    ,CNT_PTY_ACCT_PROV
                    ,GMT_CREATE
                    ,TRANS_TIME
                    ,FINISH_TIME
                    ,ACCOUNT_DATE
                    ,GMT_MODIFIED
                    ,CNT_PTY_ACCT_TYPE
                    ,PROC_TIME
                    ,PLAN_ACCT_CHANNEL
                    ,CNT_PTY_ACCT_CHANNEL
                    ,EXEC_TIMES
                    ,LAST_EXEC_TIME
                    ,NEXT_EXEC_TIME
            )VALUES(
                     SEQ_ABS_PLAN_CAPITAL_ORDER.nextval
                    , #{cfrmAmt,jdbcType=BIGINT}
                    , #{transAmt,jdbcType=BIGINT}
                    , #{payableAmt,jdbcType=BIGINT}
                    , #{memo,jdbcType=VARCHAR}
                    , #{bizNo,jdbcType=VARCHAR}
                    , #{seqNo,jdbcType=VARCHAR}
                    , #{planNo,jdbcType=VARCHAR}
                    , #{status,jdbcType=VARCHAR}
                    , #{context,jdbcType=VARCHAR}
                    , #{planAcct,jdbcType=VARCHAR}
                    , #{planAcctType,jdbcType=VARCHAR}
                    , #{outAcptNo,jdbcType=VARCHAR}
                    , #{transType,jdbcType=VARCHAR}
                    , #{cntPtyAcct,jdbcType=VARCHAR}
                    , #{cntPtyCode,jdbcType=VARCHAR}
                    , #{outTransNo,jdbcType=VARCHAR}
                    , #{capitalType,jdbcType=VARCHAR}
                    , #{planAcctBank,jdbcType=VARCHAR}
                    , #{planAcctCity,jdbcType=VARCHAR}
                    , #{planAcctName,jdbcType=VARCHAR}
                    , #{planAcctProv,jdbcType=VARCHAR}
                    , #{cntPtyAcctBank,jdbcType=VARCHAR}
                    , #{cntPtyAcctCity,jdbcType=VARCHAR}
                    , #{cntPtyAcctName,jdbcType=VARCHAR}
                    , #{cntPtyAcctProv,jdbcType=VARCHAR}
                    , sysdate
                    , #{transTime,jdbcType=TIMESTAMP}
                    , #{finishTime,jdbcType=TIMESTAMP}
                    , #{accountDate,jdbcType=TIMESTAMP}
                    , sysdate
                    , #{cntPtyAcctType,jdbcType=VARCHAR}
                    , #{procTime,jdbcType=TIMESTAMP}
                    , #{planAcctChannel,jdbcType=VARCHAR}
                    , #{cntPtyAcctChannel,jdbcType=VARCHAR}
                    , 0
                    , null
                    , #{nextExecTime,jdbcType=TIMESTAMP}
            )
            ]]>
    </operation>

    <operation name="insertHis" paramtype="object" remark="插入表:ABS_PLAN_CAPITAL_ORDER" >
        <![CDATA[
            INSERT INTO ABS_PLAN_CAPITAL_ORDER_HIS(
                    ID
                    ,CFRM_AMT
                    ,TRANS_AMT
                    ,PAYABLE_AMT
                    ,MEMO
                    ,BIZ_NO
                    ,SEQ_NO
                    ,PLAN_NO
                    ,STATUS
                    ,CONTEXT
                    ,PLAN_ACCT
                    ,PLAN_ACCT_TYPE
                    ,OUT_ACPT_NO
                    ,TRANS_TYPE
                    ,CNT_PTY_ACCT
                    ,CNT_PTY_CODE
                    ,OUT_TRANS_NO
                    ,CAPITAL_TYPE
                    ,PLAN_ACCT_BANK
                    ,PLAN_ACCT_CITY
                    ,PLAN_ACCT_NAME
                    ,PLAN_ACCT_PROV
                    ,CNT_PTY_ACCT_BANK
                    ,CNT_PTY_ACCT_CITY
                    ,CNT_PTY_ACCT_NAME
                    ,CNT_PTY_ACCT_PROV
                    ,GMT_CREATE
                    ,TRANS_TIME
                    ,FINISH_TIME
                    ,ACCOUNT_DATE
                    ,GMT_MODIFIED
                    ,CNT_PTY_ACCT_TYPE
                    ,PROC_TIME
                    ,PLAN_ACCT_CHANNEL
                    ,CNT_PTY_ACCT_CHANNEL
            )VALUES(
                      SEQ_ABS_PLAN_CAPITAL_ORDER.nextval
                    , #{cfrmAmt,jdbcType=BIGINT}
                    , #{transAmt,jdbcType=BIGINT}
                    , #{payableAmt,jdbcType=BIGINT}
                    , #{memo,jdbcType=VARCHAR}
                    , #{bizNo,jdbcType=VARCHAR}
                    , #{seqNo,jdbcType=VARCHAR}
                    , #{planNo,jdbcType=VARCHAR}
                    , #{status,jdbcType=VARCHAR}
                    , #{context,jdbcType=VARCHAR}
                    , #{planAcct,jdbcType=VARCHAR}
                    , #{planAcctType,jdbcType=VARCHAR}
                    , #{outAcptNo,jdbcType=VARCHAR}
                    , #{transType,jdbcType=VARCHAR}
                    , #{cntPtyAcct,jdbcType=VARCHAR}
                    , #{cntPtyCode,jdbcType=VARCHAR}
                    , #{outTransNo,jdbcType=VARCHAR}
                    , #{capitalType,jdbcType=VARCHAR}
                    , #{planAcctBank,jdbcType=VARCHAR}
                    , #{planAcctCity,jdbcType=VARCHAR}
                    , #{planAcctName,jdbcType=VARCHAR}
                    , #{planAcctProv,jdbcType=VARCHAR}
                    , #{cntPtyAcctBank,jdbcType=VARCHAR}
                    , #{cntPtyAcctCity,jdbcType=VARCHAR}
                    , #{cntPtyAcctName,jdbcType=VARCHAR}
                    , #{cntPtyAcctProv,jdbcType=VARCHAR}
                    , sysdate
                    , #{transTime,jdbcType=TIMESTAMP}
                    , #{finishTime,jdbcType=TIMESTAMP}
                    , #{accountDate,jdbcType=TIMESTAMP}
                    , sysdate
                    , #{cntPtyAcctType,jdbcType=VARCHAR}
                    , #{procTime,jdbcType=TIMESTAMP}
                    , #{planAcctChannel,jdbcType=VARCHAR}
                    , #{cntPtyAcctChannel,jdbcType=VARCHAR}
            )
            ]]>
    </operation>

    <!-- foreach 可以自定义类型，paramtype="primitive" foreach->javatype="自己书写的类"  -->
    <!-- 只有一个参数且为List时必须将参数命名为list -->
    <operation name="insertBatch" paramtype="objectList" remark="批量插入表:ABS_PLAN_CAPITAL_ORDER"  >
        <foreach collection="list" item="item" separator=";">
            INSERT INTO ABS_PLAN_CAPITAL_ORDER(
                ID
                ,CFRM_AMT
                ,TRANS_AMT
                ,PAYABLE_AMT
                ,MEMO
                ,BIZ_NO
                ,SEQ_NO
                ,PLAN_NO
                ,STATUS
                ,CONTEXT
                ,PLAN_ACCT
                ,PLAN_ACCT_TYPE
                ,OUT_ACPT_NO
                ,TRANS_TYPE
                ,CNT_PTY_ACCT
                ,CNT_PTY_CODE
                ,OUT_TRANS_NO
                ,CAPITAL_TYPE
                ,PLAN_ACCT_BANK
                ,PLAN_ACCT_CITY
                ,PLAN_ACCT_NAME
                ,PLAN_ACCT_PROV
                ,CNT_PTY_ACCT_BANK
                ,CNT_PTY_ACCT_CITY
                ,CNT_PTY_ACCT_NAME
                ,CNT_PTY_ACCT_PROV
                ,GMT_CREATE
                ,TRANS_TIME
                ,FINISH_TIME
                ,ACCOUNT_DATE
                ,GMT_MODIFIED
                ,CNT_PTY_ACCT_TYPE
                ,PROC_TIME
                ,PLAN_ACCT_CHANNEL
                ,CNT_PTY_ACCT_CHANNEL
                ,EXEC_TIMES
                ,LAST_EXEC_TIME
                ,NEXT_EXEC_TIME
            )VALUES(
                SEQ_ABS_PLAN_CAPITAL_ORDER.nextval
                , #{item.cfrmAmt,jdbcType=BIGINT}
                , #{item.transAmt,jdbcType=BIGINT}
                , #{item.payableAmt,jdbcType=BIGINT}
                , #{item.memo,jdbcType=VARCHAR}
                , #{item.bizNo,jdbcType=VARCHAR}
                , #{item.seqNo,jdbcType=VARCHAR}
                , #{item.planNo,jdbcType=VARCHAR}
                , #{item.status,jdbcType=VARCHAR}
                , #{item.context,jdbcType=VARCHAR}
                , #{item.planAcct,jdbcType=VARCHAR}
                , #{item.planAcctType,jdbcType=VARCHAR}
                , #{item.outAcptNo,jdbcType=VARCHAR}
                , #{item.transType,jdbcType=VARCHAR}
                , #{item.cntPtyAcct,jdbcType=VARCHAR}
                , #{item.cntPtyCode,jdbcType=VARCHAR}
                , #{item.outTransNo,jdbcType=VARCHAR}
                , #{item.capitalType,jdbcType=VARCHAR}
                , #{item.planAcctBank,jdbcType=VARCHAR}
                , #{item.planAcctCity,jdbcType=VARCHAR}
                , #{item.planAcctName,jdbcType=VARCHAR}
                , #{item.planAcctProv,jdbcType=VARCHAR}
                , #{item.cntPtyAcctBank,jdbcType=VARCHAR}
                , #{item.cntPtyAcctCity,jdbcType=VARCHAR}
                , #{item.cntPtyAcctName,jdbcType=VARCHAR}
                , #{item.cntPtyAcctProv,jdbcType=VARCHAR}
                , sysdate
                , #{item.transTime,jdbcType=TIMESTAMP}
                , #{item.finishTime,jdbcType=TIMESTAMP}
                , #{item.accountDate,jdbcType=TIMESTAMP}
                , sysdate
                , #{cntPtyAcctType,jdbcType=VARCHAR}
                , #{item.procTime,jdbcType=TIMESTAMP}
                , #{item.planAcctChannel,jdbcType=VARCHAR}
                , #{item.cntPtyAcctChannel,jdbcType=VARCHAR}
                , 0
                , null
                , #{item.nextExecTime,jdbcType=TIMESTAMP}
            )
        </foreach>
    </operation>

    <!-- 根据唯一约束操作数据 -->
    <operation name="updateProcess" paramtype="object" remark="根据唯一约束AbsPlanCapitalOrdr更新表:ABS_PLAN_CAPITAL_ORDER">
        <![CDATA[
        UPDATE ABS_PLAN_CAPITAL_ORDER
        SET
            STATUS              = #{status,jdbcType=VARCHAR}
            ,TRANS_TIME         = #{transTime,jdbcType=TIMESTAMP}
            ,OUT_ACPT_NO        = #{outAcptNo,jdbcType=VARCHAR}
            ,MEMO               = #{memo,jdbcType=VARCHAR}
            ,CONTEXT            = #{context,jdbcType=VARCHAR}
            ,PLAN_ACCT          = #{planAcct,jdbcType=VARCHAR}
            ,PLAN_ACCT_TYPE     = #{planAcctType,jdbcType=VARCHAR}
            ,PLAN_ACCT_BANK     = #{planAcctBank,jdbcType=VARCHAR}
            ,PLAN_ACCT_CITY     = #{planAcctCity,jdbcType=VARCHAR}
            ,PLAN_ACCT_NAME     = #{planAcctName,jdbcType=VARCHAR}
            ,PLAN_ACCT_PROV     = #{planAcctProv,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT       = #{cntPtyAcct,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_TYPE  = #{cntPtyAcctType,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_BANK  = #{cntPtyAcctBank,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_CITY  = #{cntPtyAcctCity,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_NAME  = #{cntPtyAcctName,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_PROV  = #{cntPtyAcctProv,jdbcType=VARCHAR}
            ,PLAN_ACCT_CHANNEL  = #{planAcctChannel,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_CHANNEL = #{cntPtyAcctChannel,jdbcType=VARCHAR}
            ,EXEC_TIMES         = EXEC_TIMES + 1
            ,LAST_EXEC_TIME     = sysdate
            ,NEXT_EXEC_TIME     = #{nextExecTime,jdbcType=TIMESTAMP}
            ,GMT_MODIFIED    = sysdate
        WHERE
            SEQ_NO           = #{seqNo,jdbcType=VARCHAR}
            AND PLAN_NO      = #{planNo,jdbcType=VARCHAR}
        ]]>
    </operation>

    <!-- 全 update
    <operation name="updateResult" paramtype="object" remark="更新表:abs_plan_capital_order"  >
        <![CDATA[
        UPDATE abs_plan_capital_order
        SET
            CFRM_AMT        = #{cfrmAmt,jdbcType=DECIMAL}
            ,MEMO            = #{memo,jdbcType=VARCHAR}
            ,STATUS          = #{status,jdbcType=VARCHAR}
            ,CONTEXT         = #{context,jdbcType=VARCHAR}
            ,PLAN_ACCT       = #{planAcct,jdbcType=VARCHAR}
            ,TRANS_TYPE      = #{transType,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT    = #{cntPtyAcct,jdbcType=VARCHAR}
            ,CNT_PTY_CODE    = #{cntPtyCode,jdbcType=VARCHAR}
            ,OUT_TRANS_NO    = #{outTransNo,jdbcType=VARCHAR}
            ,CAPITAL_TYPE    = #{capitalType,jdbcType=VARCHAR}
            ,PLAN_ACCT_BANK  = #{planAcctBank,jdbcType=VARCHAR}
            ,PLAN_ACCT_CITY  = #{planAcctCity,jdbcType=VARCHAR}
            ,PLAN_ACCT_NAME  = #{planAcctName,jdbcType=VARCHAR}
            ,PLAN_ACCT_PROV  = #{planAcctProv,jdbcType=VARCHAR}
            ,PLAN_ACCT_TYPE  = #{planAcctType,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_BANK = #{cntPtyAcctBank,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_CITY = #{cntPtyAcctCity,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_NAME = #{cntPtyAcctName,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_PROV = #{cntPtyAcctProv,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_TYPE = #{cntPtyAcctType,jdbcType=VARCHAR}
            ,PLAN_ACCT_CHANNEL = #{planAcctChannel,jdbcType=VARCHAR}
            ,CNT_PTY_ACCT_CHANNEL = #{cntPtyAcctChannel,jdbcType=VARCHAR}
            ,EXEC_TIMES         = 0
            ,LAST_EXEC_TIME     = sysdate
            ,NEXT_EXEC_TIME     = #{nextExecTime,jdbcType=TIMESTAMP}
            ,FINISH_TIME     = #{finishTime,jdbcType=DATE}
            ,GMT_MODIFIED    = sysdate
        WHERE
            SEQ_NO           = #{seqNo,jdbcType=VARCHAR}
            AND
            PLAN_NO      = #{planNo,jdbcType=VARCHAR}
        ]]>
    </operation> -->

    <!-- 全 update -->
    <operation name="restoreCapitalOrder" paramtype="primitive" remark="失败的交易重新发起"  >
        <![CDATA[
        UPDATE ABS_PLAN_CAPITAL_ORDER
        SET
            STATUS          = 'init'
            ,EXEC_TIMES      = EXEC_TIMES + 1
            ,NEXT_EXEC_TIME  = #{nextExecTime,jdbcType=TIMESTAMP}
            ,GMT_MODIFIED    = sysdate
        WHERE
            SEQ_NO           = #{seqNo,jdbcType=VARCHAR}
            AND
            STATUS      = 'wait'
        ]]>
    </operation>


    <operation name="deleteBySeqno" remark="根据唯一约束AbsPlanCapitalOrdr删除数据:ABS_PLAN_CAPITAL_ORDER">
        <![CDATA[
        DELETE FROM ABS_PLAN_CAPITAL_ORDER
        WHERE
            SEQ_NO          = #{seqNo,jdbcType=VARCHAR}
            AND PLAN_NO         = #{planNo,jdbcType=VARCHAR}
        ]]>
    </operation>

    <operation name="lockBySeqno" multiplicity="one" remark="根据唯一约束AbsPlanCapitalLog获取数据:abs_plan_capital_log">
        SELECT *
        FROM ABS_PLAN_CAPITAL_ORDER
        WHERE
        <![CDATA[
            SEQ_NO          = #{seqNo,jdbcType=VARCHAR}
            FOR UPDATE NOWAIT
        ]]>
    </operation>

    <operation name="lockActiveByPlanNo" multiplicity="one" remark="根据唯一约束AbsPlanCapitalLog获取数据:abs_plan_capital_log">
        SELECT *
        FROM ABS_PLAN_CAPITAL_ORDER
        WHERE
        <![CDATA[
            PLAN_NO          = #{planNo,jdbcType=VARCHAR}
            AND TRANS_TYPE = #{transType,jdbcType=VARCHAR}
            AND ACCOUNT_DATE = #{accountDate,jdbcType=TIMESTAMP}
            AND STATUS = 'init'
            FOR UPDATE NOWAIT
        ]]>
    </operation>

    <operation name="getInitListByPlanNo" multiplicity="many" remark="根据唯一约束AbsPlanCapitalLog获取数据:abs_plan_capital_log">
        SELECT *
        FROM ABS_PLAN_CAPITAL_ORDER
        WHERE
            STATUS = 'init'
        <if test="planNo!=null and planNo != ''">
            AND PLAN_NO = #{planNo,jdbcType=VARCHAR}
        </if>
    </operation>

    <operation name="getActiveListByPlanNo" multiplicity="many" remark="根据唯一约束AbsPlanCapitalLog获取数据:abs_plan_capital_log">
        SELECT *
        FROM ABS_PLAN_CAPITAL_ORDER
        WHERE
        PLAN_NO          = #{planNo,jdbcType=VARCHAR}
        AND STATUS IN ('init', 'wait')
        <if test="accountDate != null">
        AND ACCOUNT_DATE = #{accountDate,jdbcType=DATE}
        </if>
        ORDER BY ID ASC
    </operation>

    <operation name="getCapitalOrderByStatus" multiplicity="paging" paging="PlanCapitalOrder" remark="根据状态分页查询订单">
        SELECT *
        FROM ABS_PLAN_CAPITAL_ORDER
        WHERE
            ID &gt; #{id,jdbcType=BIGINT}
            AND NEXT_EXEC_TIME     &lt;= #{nextExecTime,jdbcType=DATE}
        <if test="planNo!=null and planNo != ''">
            AND PLAN_NO = #{planNo,jdbcType=VARCHAR}
        </if>
        <if test="status!=null and status != ''">
            AND STATUS = #{status,jdbcType=VARCHAR}
        </if>
        <if test="accountDate != null">
            AND ACCOUNT_DATE = #{accountDate,jdbcType=DATE}
        </if>
        ORDER BY ID ASC
    </operation>

    <operation name="queryFailCapitalOrder" multiplicity="many" remark="查询执行次数较多的交易单">
        select *
        FROM  ABS_PLAN_CAPITAL_ORDER  sf
        where
        EXEC_TIMES      &gt; #{execTimes,jdbcType=INTEGER}
        <if test="accountDate != null">
            AND ACCOUNT_DATE = #{accountDate,jdbcType=DATE}
        </if>
        <if test="list != null and list.size() &gt; 0">
            AND
            STATUS	in
            <foreach collection="list" item="status" separator="," open="(" close=")">
                #{status,jdbcType=VARCHAR}
            </foreach>
        </if>
        ORDER BY GMT_MODIFIED, ID
    </operation>

    <operation name="getActiveCount" multiplicity="one" resulttype="int" remark="根据唯一约束AbsPlanCapitalLog获取数据:abs_plan_capital_log">
        SELECT COUNT(id) cnt
        FROM ABS_PLAN_CAPITAL_ORDER
        WHERE
        STATUS in ('init','wait')
        <if test="accountDate != null">
            AND ACCOUNT_DATE = #{accountDate,jdbcType=DATE}
        </if>
    </operation>


    <operation name="getFailCount" multiplicity="one" resulttype="java.lang.Long" remark="查询失败数量">
        SELECT COUNT(*) cnt
        FROM ABS_PLAN_CAPITAL_ORDER
        WHERE
        EXEC_TIMES      &gt; #{execTimes,jdbcType=INTEGER}
    </operation>

    <operation name="queryOrderListByOutAcptNo" multiplicity="many" remark="根据外部交易编码查询交易单用来做mock数据">
        SELECT *
        FROM ABS_PLAN_CAPITAL_ORDER
        WHERE
        OUT_ACPT_NO IN
        <foreach collection="noList" item="outAcptNo" separator="," open="(" close=")">
            #{outAcptNo,jdbcType=VARCHAR}
        </foreach>
    </operation>
</table>
